(function(e,b,d){var f=b.setTransform,a=[1,0,0,1,0,0],c=function(l,k,g,j,i){var p=l.ctx,h=p.canvas,q=g||a,n={canim:l,img:k,_delay:j||0,_duration:i,angle:0,_start:q,_m:[1,0,0,1,q[4],q[5]],_stop:false},m=function(r,s){return[r[0]*s[0]+r[2]*s[1],r[1]*s[0]+r[3]*s[1],r[0]*s[2]+r[2]*s[3],r[1]*s[2]+r[3]*s[3],r[0]*s[4]+r[2]*s[5]+r[4],r[1]*s[4]+r[3]*s[5]+r[5]]},o=function(r){var v=Math.cos(r),u=Math.sin(r);return[v,-u,u,v,0,0]};n.end=function(){return m(n._m,o(n.angle))};n.next=function(r){return n.stop().canim.sprite(k,n.end(),n._delay+n._duration,r)};n.getTransform=function(u){var w=n._delay,v=n._duration,s=v==0?1:(u-w)/v,r=n._m;s=s>1?1:n._ease(s);return m(n._start.map(function(y,x){return(r[x]-y)*s+y}),o(n.angle*s))};n.transform=function(s,r){r?n._start=m(n._start,s):n._m=m(n._m,s);return n};n.rotate=function(u,s){s?n._start=m(n._start,o(u)):n.angle+=u;return n};n.scale=function(u,s,r){return n.transform([u,0,0,s||u,0,0],r)};n.moveTo=n.move=n.translate=function(r,u,s){return n.transform([1,0,0,1,r,u],s)};n.start=function(r,s){n.move(r,s,true);return n.move(r,s)};n.setTransform=function(r){n._m=r;return n};n.delay=function(r){n._delay=r;return n};n.duration=function(r){n._duration=r;return n};n.stop=function(){n._stop=true;return n};n.ease=function(r){n._ease=new d(r);return n};n.draw=function(){if(l.current<n._delay||(n._stop&&l.current>n._delay+n._duration)){return}b.transform.apply(p,t=n.getTransform(l.current));if(typeof k=="function"){k.call(n,p)}else{var r=k.naturalWidth,s=k.naturalHeight;p.drawImage(k,-r/2,-s/2);p.rect(-r/2,-s/2,r,s)}console.log(p.isPointInPath(t[4]-r/2+100,t[5]))};n.on=function(r,s){h.addEventListener(r,function(y){var z=y.touches&&y.touches[0]||y,v=h.getBoundingClientRect(),w=l.t,u=[1,0,0,1,(z.clientX-v.left-w[4])/w[0],(z.clientY-v.top-w[5])/w[0]],x=m(u,t);if(p.isPointInPath(u[4],u[5])){s(n)}},false)};return n};b.scene=function(r,g,h,s,k,o,v){var j=function(){return new Date().getTime()/1000},u=this,i=u.canvas,n=e.requestAnimationFrame||e.webkitRequestAnimationFrame||e.mozRequestAnimationFrame||function(w){e.setTimeout(w,1000/60)},p={ctx:u,begin:j(),end:k,sprites:o||[]},m=function(){i.width=h;i.height=s;f.apply(u,a);u.clearRect(0,0,h,s)},q=function(){p.current=j()-p.begin;if(p.end&&p.current>=p.end){return}m();p.sprites.forEach(function(w){f.apply(u,p.t);w.draw()});n(q)},l=function(){var x=h,z=s,A=x/z,y=r/g,C=x/r,B=z/g;p.t=A>y?[C,0,0,C,0,(z-x/y)/2]:[B,0,0,B,(x-z*y)/2,0]};p.start=function(){q()};p.sprite=function(w,A,x,z){var y=c(p,w,A,x,z);p.sprites.push(y);return y};l(),m(),v&&q();return p}})(window,CanvasRenderingContext2D.prototype,window.Ease||function(){return function(a){return a}});