(function(d,a,c){var b=function(i,h,e,g,f){var m=i.ctx,n=e||[1,0,0,1,0,0],k={canim:i,img:h,_delay:g||0,_duration:f,angle:0,_start:n,_m:[1,0,0,1,n[4],n[5]],_stop:false},j=function(o,p){return[o[0]*p[0]+o[2]*p[1],o[1]*p[0]+o[3]*p[1],o[0]*p[2]+o[2]*p[3],o[1]*p[2]+o[3]*p[3],o[0]*p[4]+o[2]*p[5]+o[4],o[1]*p[4]+o[3]*p[5]+o[5]]},l=function(o){var q=Math.cos(o),p=Math.sin(o);return[q,-p,p,q,0,0]};k.end=function(){return j(k._m,l(k.angle))};k.next=function(o){return k.stop().canim.sprite(h,k.end(),k._delay+k._duration,o)};k.getTransform=function(q){var s=k._delay,r=k._duration,p=r==0?1:(q-s)/r,o=k._m;p=p>1?1:k._ease(p);return j(k._start.map(function(u,t){return(o[t]-u)*p+u}),l(k.angle*p))};k.transform=function(p,o){o?k._start=j(k._start,p):k._m=j(k._m,p);return k};k.rotate=function(p,o){o?k._start=j(k._start,l(p)):k.angle+=p;return k};k.scale=function(q,p,o){return k.transform([q,0,0,p||q,0,0],o)};k.move=k.translate=function(o,q,p){return k.transform([1,0,0,1,o,q],p)};k.start=function(o,p){k._start[4]=o;k._start[5]=p;return k.move(o,p)};k.moveTo=function(o,p){k._m[4]=o;k._m[5]=p;return k};k.setTransform=function(o){k._m=o;return k};k.delay=function(o){k._delay=o;return k};k.duration=function(o){k._duration=o;return k};k.stop=function(){k._stop=true;return k};k.ease=function(o){k._ease=new c(o);return k};k.draw=function(){if(i.current<k._delay||(k._stop&&i.current>k._delay+k._duration)){return}a.transform.apply(m,k.getTransform(i.current));if(typeof h=="function"){h.call(i,m)}else{m.drawImage(h,-h.naturalWidth/2,-h.naturalHeight/2)}};return k};a.scene=function(e,n,h,k,p){var g=function(){return new Date().getTime()/1000},o=this,f=o.canvas,j=d.requestAnimationFrame||d.webkitRequestAnimationFrame||d.mozRequestAnimationFrame||function(q){d.setTimeout(q,1000/60)},l={canvas:f,ctx:o,width:f.width,height:f.height,begin:g(),end:h,sprites:k||[]},i=function(){f.width=e;f.height=n;o.setTransform(1,0,0,1,0,0);o.clearRect(0,0,e,n)},m=function(){l.current=g()-l.begin;if(l.end&&l.current>=l.end){return}i();l.sprites.forEach(function(q){a.setTransform.apply(o,l.getTransform());q.draw()});j(m)};l.getTransform=function(){var q=e,s=n,t=q/s,r=l.width/l.height,v=q/l.width,u=s/l.height;l._t=t>r?[v,0,0,v,0,(s-q/r)/2]:[u,0,0,u,(q-s*r)/2,0];return l._t};l.start=function(){m()};l.sprite=function(q,v,r,u){var t=b(l,q,v,r,u);l.sprites.push(t);return t};i()&&p&&m();return l}})(window,CanvasRenderingContext2D.prototype,window.Ease||function(){return function(a){return a}});