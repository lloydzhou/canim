(function(a,c){var b=function(h,g,d,f,e){var l=h.ctx,m=d||[1,0,0,1,0,0],j={canim:h,img:g,_delay:f||0,_duration:e,angle:0,_start:m,_m:[1,0,0,1,m[4],m[5]],_stop:false},i=function(o,p){return[o[0]*p[0]+o[2]*p[1],o[1]*p[0]+o[3]*p[1],o[0]*p[2]+o[2]*p[3],o[1]*p[2]+o[3]*p[3],o[0]*p[4]+o[2]*p[5]+o[4],o[1]*p[4]+o[3]*p[5]+o[5]]},k=function(n){var p=Math.cos(n),o=Math.sin(n);return[p,-o,o,p,0,0]};j.end=function(){return i(j._m,k(j.angle))};j.next=function(n){return j.stop().canim.sprite(g,j.end(),j._delay+j._duration,n)};j.getTransform=function(p){var r=j._delay,q=j._duration,o=q==0?1:(p-r)/q,n=j._m;o=o>1?1:j._ease(o);return i(j._start.map(function(t,s){return(n[s]-t)*o+t}),k(j.angle*o))};j.transform=function(p,o){o?j._start=i(j._start,p):j._m=i(j._m,p);return j};j.rotate=function(o,n){n?j._start=i(j._start,k(o)):j.angle+=o;return j};j.scale=function(p,o,n){return j.transform([p,0,0,o||p,0,0],n)};j.move=j.translate=function(n,p,o){return j.transform([1,0,0,1,n,p],o)};j.start=function(n,o){j._start[4]=n;j._start[5]=o;return j.move(n,o)};j.moveTo=function(n,o){j._m[4]=n;j._m[5]=o;return j};j.setTransform=function(n){j._m=n;return j};j.delay=function(n){j._delay=n;return j};j.duration=function(n){j._duration=n;return j};j.stop=function(){j._stop=true;return j};j.ease=function(n){j._ease=new c(n);return j};j.draw=function(){if(j.canim.current<j._delay){return}else{if(j._stop&&h.current>j._delay+j._duration){j.onend&&j.onend(j);return j.onend=null}else{if(j.onstart){j.onstart(j);j.onstart=null}}}a.transform.apply(l,j.getTransform(h.current));if(typeof g=="function"){g.call(h,l)}else{l.drawImage(g,-g.naturalWidth/2,-g.naturalHeight/2)}};return j};a.scene=function(d,m,g,j,o){var f=function(){return new Date().getTime()/1000},n=this,e=n.canvas,i=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(p){window.setTimeout(p,1000/60)},k={canvas:e,ctx:n,width:e.width,height:e.height,begin:f(),end:g,sprites:j||[]},h=function(){e.width=d;e.height=m;n.setTransform(1,0,0,1,0,0);n.clearRect(0,0,d,m)},l=function(){k.current=f()-k.begin;if(k.end&&k.current>=k.end){return 0}h();k.sprites.forEach(function(p){a.setTransform.apply(n,k.getTransform());p.draw()});i(l)};k.getTransform=function(){var p=d,r=m,s=p/r,q=k.width/k.height,u=p/k.width,t=r/k.height;k._t=s>q?[u,0,0,u,0,(r-p/q)/2]:[t,0,0,t,(p-r*q)/2,0];return k._t};k.start=function(){l()};k.sprite=function(p,u,q,t){var r=b(k,p,u,q,t);k.sprites.push(r);return r};h()&&o&&k.start();return k}})(CanvasRenderingContext2D.prototype,window.Ease||function(){return function(a){return a}});