(function(d,a,c){var b=function(i,h,e,g,f){var m=i.ctx,n=e||[1,0,0,1,0,0],k={canim:i,img:h,_delay:g||0,_duration:f,angle:0,_start:n,_m:[1,0,0,1,n[4],n[5]],_stop:false},j=function(o,p){return[o[0]*p[0]+o[2]*p[1],o[1]*p[0]+o[3]*p[1],o[0]*p[2]+o[2]*p[3],o[1]*p[2]+o[3]*p[3],o[0]*p[4]+o[2]*p[5]+o[4],o[1]*p[4]+o[3]*p[5]+o[5]]},l=function(o){var q=Math.cos(o),p=Math.sin(o);return[q,-p,p,q,0,0]};k.end=function(){return j(k._m,l(k.angle))};k.next=function(o){return k.stop().canim.sprite(h,k.end(),k._delay+k._duration,o)};k.getTransform=function(q){var s=k._delay,r=k._duration,p=r==0?1:(q-s)/r,o=k._m;p=p>1?1:k._ease(p);return j(k._start.map(function(u,t){return(o[t]-u)*p+u}),l(k.angle*p))};k.transform=function(p,o){o?k._start=j(k._start,p):k._m=j(k._m,p);return k};k.rotate=function(p,o){o?k._start=j(k._start,l(p)):k.angle+=p;return k};k.scale=function(q,p,o){return k.transform([q,0,0,p||q,0,0],o)};k.moveTo=k.move=k.translate=function(o,q,p){return k.transform([1,0,0,1,o,q],p)};k.start=function(o,p){k.move(o,p,true);return k.move(o,p)};k.setTransform=function(o){k._m=o;return k};k.delay=function(o){k._delay=o;return k};k.duration=function(o){k._duration=o;return k};k.stop=function(){k._stop=true;return k};k.ease=function(o){k._ease=new c(o);return k};k.draw=function(){if(i.current<k._delay||(k._stop&&i.current>k._delay+k._duration)){return}a.transform.apply(m,k.getTransform(i.current));if(typeof h=="function"){h.call(i,m)}else{m.drawImage(h,-h.naturalWidth/2,-h.naturalHeight/2)}};return k};a.scene=function(e,o,h,l,q){var g=function(){return new Date().getTime()/1000},p=this,f=p.canvas,k=d.requestAnimationFrame||d.webkitRequestAnimationFrame||d.mozRequestAnimationFrame||function(r){d.setTimeout(r,1000/60)},m={canvas:f,ctx:p,width:f.width,height:f.height,begin:g(),end:h,sprites:l||[]},j=function(){f.width=e;f.height=o;p.setTransform(1,0,0,1,0,0);p.clearRect(0,0,e,o)},n=function(){m.current=g()-m.begin;if(m.end&&m.current>=m.end){return}j();m.sprites.forEach(function(r){a.setTransform.apply(p,m._t);r.draw()});k(n)},i=function(){var r=e,t=o,u=r/t,s=m.width/m.height,x=r/m.width,v=t/m.height;m._t=u>s?[x,0,0,x,0,(t-r/s)/2]:[v,0,0,v,(r-t*s)/2,0]};m.start=function(){n()};m.sprite=function(r,w,t,v){var u=b(m,r,w,t,v);m.sprites.push(u);return u};i(),j(),q&&n();return m}})(window,CanvasRenderingContext2D.prototype,window.Ease||function(){return function(a){return a}});